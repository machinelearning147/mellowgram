import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import{sampleThumbs}from'../utils/mockdata';import SparkleFAB from'../shared/SparkleFAB';import{getImage}from'../utils/storage';export default function Viewer(){const{id}=useParams();const nav=useNavigate();const[userImage,setUserImage]=useState(null);useEffect(()=>{async function load(){if(!id)return;if(id.startsWith('img_')){const rec=await getImage(id);if(rec){const url=URL.createObjectURL(rec.blob);setUserImage({url,meta:rec.meta,createdAt:rec.createdAt});}}}load();return()=>{if(userImage?.url)URL.revokeObjectURL(userImage.url);};},[id]);if(id&&id.startsWith('s')){const numeric=Number(id.slice(1));const s=sampleThumbs.find(x=>x.id===numeric)||sampleThumbs[0];return(<div className='p-3'><div className='h-[60vh] rounded-xl overflow-hidden' style={{background:`linear-gradient(135deg, ${s.c1}, ${s.c2})`}}></div><div className='mt-3 p-3 bg-white rounded-xl shadow-sm'><div className='text-sm text-[var(--text-muted)]'>Soft summer evenings · 12 July 2023</div><p className='mt-2 text-base'>This frame feels warm and quiet — a memory worth saving.</p><div className='flex gap-2 mt-4'><button className='flex-1 py-2 rounded-xl bg-gradient-to-r from-[var(--accent-lav)] to-[var(--accent-peach)]'>Generate Story</button><button className='py-2 px-3 rounded-xl bg-white border'>Share</button></div></div><SparkleFAB/></div>);}return(<div className='p-3'><div className='h-[60vh] rounded-xl overflow-hidden bg-gray-100'>{userImage?.url?<img src={userImage.url} className='w-full h-full object-cover' alt=''/>:<div className='flex items-center justify-center h-full text-[var(--text-muted)]'>Loading…</div>}</div><div className='mt-3 p-3 bg-white rounded-xl shadow-sm'><div className='text-sm text-[var(--text-muted)]'>{userImage?.meta?.name||'Uploaded photo'} · {userImage?.createdAt?.slice(0,10)}</div><p className='mt-2 text-base'>Saved locally to your browser. Sync to cloud later.</p><div className='flex gap-2 mt-4'><button className='flex-1 py-2 rounded-xl bg-gradient-to-r from-[var(--accent-lav)] to-[var(--accent-peach)]'>Generate Story</button><button className='py-2 px-3 rounded-xl bg-white border'>Share</button></div><div className='mt-3 text-sm text-[var(--text-muted)]'><button onClick={()=>nav(-1)} className='text-blue-600'>Back</button></div></div><SparkleFAB/></div>);}