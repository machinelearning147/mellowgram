import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import SparkleFAB from'../shared/SparkleFAB';import ImageUploader from'../shared/ImageUploader';import{sampleThumbs}from'../utils/mockdata';import{listImages}from'../utils/storage';export default function Home(){const[userImages,setUserImages]=useState([]);async function refresh(){const items=await listImages();const withUrl=await Promise.all(items.map(async rec=>{let url;try{url=URL.createObjectURL(rec.blob);}catch(e){url='';}return{id:rec.id,url,meta:rec.meta,createdAt:rec.createdAt};}));setUserImages(withUrl);}useEffect(()=>{refresh();return()=>{userImages.forEach(i=>{if(i.url)URL.revokeObjectURL(i.url);});};},[]);const displayItems=[...sampleThumbs.map(s=>({id:'s'+s.id,gradient:`linear-gradient(135deg, ${s.c1}, ${s.c2})`,isSample:true})),...userImages.map(u=>({id:u.id,url:u.url,isSample:false}))];return(<div className='p-4'><div className='flex items-center justify-between mb-3'><div className='text-sm text-[var(--text-muted)]'>Your moments, organized.</div><ImageUploader onUpload={refresh}/></div><div className='grid grid-cols-3 gap-3'>{displayItems.map(item=>item.isSample?(<Link to={`/viewer/${item.id}`} key={item.id} className='block'><div className='w-full aspect-square rounded-xl shadow-sm overflow-hidden' style={{background:item.gradient}}/></Link>):(<Link to={`/viewer/${item.id}`} key={item.id} className='block'><div className='w-full aspect-square rounded-xl shadow-sm overflow-hidden bg-gray-100'>{item.url?<img src={item.url} alt='' className='w-full h-full object-cover'/>:null}</div></Link>))}</div><div className='mt-6'><Link to='/albums' className='inline-block rounded-full px-4 py-2 bg-white shadow-sm'>View Albums</Link></div><SparkleFAB/></div>);}